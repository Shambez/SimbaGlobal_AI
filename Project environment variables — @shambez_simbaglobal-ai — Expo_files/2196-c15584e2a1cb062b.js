try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="77040783-e87a-4250-8b2e-b52158a36688",e._sentryDebugIdIdentifier="sentry-dbid-77040783-e87a-4250-8b2e-b52158a36688")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2196],{215758:(e,t,n)=>{n.d(t,{x:()=>m});var s=n(637876),a=n(766028),l=n(74555),o=n(827230),r=n(944630),i=n(182172),d=n(14232),c=n(888798),u=n(159452),h=n(197093),f=n(862026),x=n(728992),p=n(10369),g=n(434743);function m(e){var t;let{data:n,lines:m}=e,{forceDarkMode:j}=(0,u.Ao)(),[w,v]=(0,d.useState)(!0),[y,k]=(0,d.useState)(!1),N=(0,d.useRef)(null),S=(null!=(t=null!=m?m:null==n?void 0:n.trim().split("\n"))?t:["The file is empty."]).map(e=>""===e?"â€‹":e);return(0,s.jsxs)(f.t,{className:(0,a.mergeClasses)("relative border-t","dark:bg-palette-black",j?"dark-theme border-t-transparent bg-palette-black":"border-t-secondary dark:border-t-transparent"),children:[(0,s.jsx)(c.aY,{ref:N,defaultItemHeight:21,style:{height:16*Math.min(S.length,30)},totalCount:S.length,overscan:100,itemContent:e=>(0,s.jsx)("p",{className:"px-4 text-2xs text-default",children:S[e]}),atTopStateChange:e=>{k(!e)},atBottomStateChange:e=>{v(!e)},components:{Header:b,Footer:b}}),(0,s.jsxs)(r.N,{children:[y&&(0,s.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute right-4 top-4",children:(0,s.jsxs)(p.s,{children:[(0,s.jsx)(g.k,{asChild:!0,children:(0,s.jsx)(h.$,{theme:"secondary",size:"xs",onClick:()=>{var e;return null==(e=N.current)?void 0:e.scrollTo({top:0})},leftSlot:(0,s.jsx)(o.ArrowUpIcon,{}),className:"rounded-full"})}),(0,s.jsx)(x.Z,{children:(0,s.jsx)("p",{className:"text-xs",children:"Scroll to top"})})]})}),w&&(0,s.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute bottom-4 right-4",children:(0,s.jsxs)(p.s,{children:[(0,s.jsx)(g.k,{asChild:!0,children:(0,s.jsx)(h.$,{theme:"secondary",size:"xs",onClick:()=>{var e;return null==(e=N.current)?void 0:e.scrollToIndex({index:"LAST"})},leftSlot:(0,s.jsx)(l.ArrowDownIcon,{}),className:"rounded-full"})}),(0,s.jsx)(x.Z,{children:(0,s.jsx)("p",{className:"text-xs",children:"Scroll to bottom"})})]})})]})]})}function b(){return(0,s.jsx)("div",{className:"h-4"})}},396179:(e,t,n)=>{n.d(t,{X:()=>b});var s=n(637876),a=n(234824),l=n(14232),o=n(832323),r=n(715459),i=n(159452),d=n(678107),c=n(831332),u=n(539949),h=n(942021),f=n(104103),x=n.n(f),p=n(215758),g=n(197093);function m(e){let{name:t,buildId:a,logLines:o}=e,[r,i]=(0,l.useState)(!1);if(0===o.length)return null;let d="".concat(a,"-").concat(x()(t,{trim:!1,strict:!0}).toLowerCase(),".txt");return(0,s.jsxs)("div",{className:"flex flex-col gap-4 px-4 pb-4 pt-2",children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"The logs are not displayed by default because the content is too large."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",onClick:e=>{e.stopPropagation()},children:[(0,s.jsx)(g.$,{onClick:async()=>{let{saveAs:e}=(await n.e(49473).then(n.t.bind(n,249473,23))).default;e(new Blob([o.map(e=>(function(e){let t=e.time?"[".concat(e.time,"] "):"",n=e.msg;return"".concat(t).concat(n)})(e)).join("\n")],{type:"text/plain;charset=utf-8"}),d)},size:"sm",download:d,leftSlot:(0,s.jsx)(h.Download03Icon,{}),children:"Download"}),!r&&(0,s.jsx)(g.$,{theme:"secondary",size:"sm",onClick:()=>{i(!0)},rightSlot:(0,s.jsx)(u.ArrowRightIcon,{className:"icon-sm"}),children:"View in the browser"})]}),r&&(0,s.jsx)(p.x,{lines:o.map(e=>e.msg)})]})}function b(e){var t;let{name:n,logLines:u,nextGroupStartTime:h,isJobCompleted:f,isExpanded:x,onToggle:p,buildId:g,phaseId:b,annotations:j}=e,{wrapLines:w,showLineNumbers:v,showTimestamp:y,showOutputStreamLabel:k,showBuildAnnotations:N,forceDarkMode:S}=(0,i.Ao)(),I=(0,a.useRouter)(),C=(0,o.gU)(),{startTime:E,duration:L,logLinesToDisplay:T,logLinesWithMarker:A,containsMarkers:D,endLog:_,isCustomBuild:B}=(0,r.Uj)(u,{nextGroupStartTime:h}),P=f&&T.length>5e3;if((0,l.useEffect)(()=>{N&&!P&&(null==j?void 0:j.length)&&!(null==I?void 0:I.route.includes("annotations"))&&j.forEach(e=>{e.annotations.forEach(e=>{C(o.rU.SHOW_ANNOTATION,e.analyticsData)})})},[N,null==j?void 0:j.length]),u.length===A.length&&!B)return null;let z=T.length<=40||P||!x;return(0,s.jsx)(d.M,{name:n,id:z?b:void 0,startTime:E,hasEnded:!!_||!D||f,endLogResult:null==_?void 0:_.result,duration:L,isExpanded:x,annotationsCount:N&&!P&&null!=(t=null==j?void 0:j.length)?t:0,onToggle:p,openFirstAnnotation:e=>{e.stopPropagation();let t=null==j?void 0:j[0];t&&(x||p(),setTimeout(()=>{b&&(0,r.Lr)({next:t,phaseId:b})},0))},copyValue:T.map(e=>e.msg).join("\n"),children:P?(0,s.jsx)(m,{buildId:g,name:n,logLines:T}):(0,s.jsx)(c.k,{shouldScrollToTopOfLogGroupOnHash:z,phaseId:b,lineNumberShown:v,timestampShown:y,outputStreamLabelShown:k,logLines:T,isJobCompleted:f,wrapLines:w,annotations:N?j:[],forceDarkMode:S})})}},802196:(e,t,n)=>{n.d(t,{V:()=>j});var s=n(637876),a=n(617666),l=n(14232),o=n(55033),r=n(715459),i=n(257224),d=n(766028),c=n(539949),u=n(942021),h=n(159452),f=n(194070),x=n(197093),p=n(678107),g=n(215758);function m(e){let{logsUrl:t,isExpanded:a,onToggle:o,buildId:r,nestedInBuildDetails:i}=e,{forceDarkMode:m}=(0,h.Ao)(),[b,j]=(0,l.useState)({status:"idle"}),[w,v]=(0,l.useState)(!1);if((0,l.useEffect)(function(){let e=!1;return async function(){try{let n=await fetch(t,{method:"HEAD"});!e&&n.ok&&v(!0)}catch(t){e||j({status:"error",error:t.message})}}(),function(){e=!0}},[t]),(0,l.useEffect)(function(){let e=!1;async function n(){try{let s=await fetch(t);if(s.ok){let t=await s.text();e||j({status:"success",data:t})}else if(!e){var n;j({status:"error",error:null!=(n=s.statusText)?n:"Status code ".concat(s.status)})}}catch(t){e||j({status:"error",error:t.message})}}return"loading"===b.status&&n(),function(){e=!0}},[b.status,t]),!w)return null;let y="xcode-build-".concat(r,".log");return(0,s.jsxs)(p.M,{nestedInBuildDetails:i,name:"Xcode Logs",id:"xcode-logs",isExpanded:a,onToggle:o,hasEnded:"idle"===b.status||"loading"!==b.status,children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 border-t border-secondary p-4",children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"The logs are not displayed by default because the content is too large."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",onClick:e=>{e.stopPropagation()},children:[(0,s.jsx)(x.$,{onClick:async()=>{let{saveAs:e}=(await n.e(49473).then(n.t.bind(n,249473,23))).default;"success"===b.status&&window.URL?e(new Blob([b.data],{type:"text/plain;charset=utf-8"}),y):e(t,y)},size:"sm",download:y,leftSlot:(0,s.jsx)(u.Download03Icon,{}),children:"Download"}),"idle"===b.status?(0,s.jsx)(x.$,{theme:"secondary",size:"sm",onClick:()=>{j({status:"loading"})},rightSlot:(0,s.jsx)(c.ArrowRightIcon,{className:"icon-sm"}),children:"View in the browser"}):null]}),"error"===b.status&&(0,s.jsxs)("p",{className:"text-xs text-danger",children:["An error occurred when fetching logs: ",b.error,"."]})]}),"loading"===b.status&&(0,s.jsx)("div",{className:(0,d.mergeClasses)("flex justify-center border-t py-4",m?"dark-theme border-t-transparent bg-palette-black":"border-t-secondary dark:border-t-transparent dark:bg-palette-black"),children:(0,s.jsx)(f.$,{size:"lg",className:"stroke-icon-default"})}),"success"===b.status&&(0,s.jsx)(g.x,{data:b.data})]})}var b=n(396179);function j(e){let{logs:t,isJobCompleted:n,xcodeBuildLogsUrl:d,buildId:c}=e,[u,h]=(0,l.useState)(null),[f,x]=(0,l.useState)({}),[p,g]=(0,l.useState)({}),[j,w]=(0,l.useState)(!1),[v,y]=(0,l.useState)(null),{buildPhasesNames:k,buildPhasesLogs:N,buildPhasesIds:S}=t,I=S.map(e=>e?r.nO[e]:null).filter(o.z2),{data:C}=(0,i.F_)({variables:{filters:{buildPhases:[...I,a.mL.UNKNOWN]}},skip:!n}),E=null==C?void 0:C.buildAnnotations.all,L=E?(0,r.Hd)(E,t):{},T=n&&d;return(0,l.useEffect)(function(){let e=k.length-1;if(n){let t=N[e],n=null==t?void 0:t[0],s=(null==n?void 0:n.phase)===a.mL.FAIL_BUILD;x({[e]:s}),T&&w(s);return}x({[e]:!0})},[t.buildPhasesNames,n]),(0,l.useEffect)(function(){y(window.location.href);let e=()=>{y(window.location.href)};return window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[]),(0,l.useEffect)(function(){if(null!=v){let e=v.split("#")[1];for(let[t,n]of S.entries())if(e===n&&(!u||u!==n)){g({...p,[t]:!0}),h(n);break}T&&e===r.LB&&t.buildPhasesIds.length>0&&(!u||u!==r.LB)&&(w(!0),h(r.LB))}},[v,t.buildPhasesIds,u]),(0,l.useEffect)(function(){if(u){var e;null==(e=document.getElementById(u))||e.scrollIntoView({behavior:"smooth"})}},[u]),(0,s.jsxs)("div",{children:[k.map((e,t)=>{var a,l,o,r;return(0,s.jsx)(b.X,{name:e,phaseId:null!=(o=S[t])?o:void 0,logLines:N[t],nextGroupStartTime:null==(l=N[t+1])||null==(a=l[0])?void 0:a.time,isExpanded:null!=(r=p[t])?r:f[t],onToggle:()=>{g(e=>{let n=f[t]&&void 0===e[t];return{...e,[t]:!n&&!e[t]}})},isJobCompleted:n,buildId:c,annotations:S[t]?L[S[t]]:void 0},t)}),T&&(0,s.jsx)(m,{isExpanded:j,onToggle:()=>{w(e=>!e)},logsUrl:d,buildId:c})]})}}}]);