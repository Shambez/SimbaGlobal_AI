try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8836978f-ddee-47f8-aa96-5069dd30a859",e._sentryDebugIdIdentifier="sentry-dbid-8836978f-ddee-47f8-aa96-5069dd30a859")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81627],{148194:(e,t,n)=>{n.d(t,{C:()=>a});var s=n(637876),r=n(766028);function a(e){let{children:t,className:n}=e;return(0,s.jsx)("div",{className:(0,r.mergeClasses)("flex items-center gap-2 rounded-md border border-default px-3 py-0.5",n),children:t})}},181627:(e,t,n)=>{n.d(t,{E:()=>G,b:()=>J});var s=n(637876),r=n(766028),a=n(381720),i=n(263411),l=n(9395),c=n(93250),o=n(518540),d=n(310187),u=n(972961),x=n(595361),h=n(267131),p=n(58532),m=n(14232),f=n(598861),g=n(361268),j=n(55033),y=n(194070),b=n(197093),v=n(408557),N=n(523146),I=n(443196),w=n(637155),D=n(474522),C=n(523805),T=n(549024),E=n(148194),k=n(888299),R=n(250455),L=n(648638),_=n(728992),S=n(10369),O=n(11308),A=n(434743),M=n(923333),F=n(377799);function G(e){var t;let{updateGroup:n,hideTimestamp:a,hideRuntime:i,nested:o,formState:G,canDeleteUpdate:P,republishUpdate:$,previewUpdateGroup:B,isActivityView:H}=e,U=n[0],W=n.map(e=>e.updatePlatform),[q,z]=(0,m.useState)(!1),[V,X]=(0,m.useState)(!1);(0,m.useEffect)(()=>{z(!0)},[]);let Y=(0,s.jsxs)(C.n,{isActivityView:H,mobilePrimaryCell:!0,theme:"interactive",className:(0,r.mergeClasses)("w-full flex-col justify-center self-stretch truncate",o&&"pl-6"),children:[(0,s.jsx)(T.k,{className:"truncate font-medium",children:null!=(t=U.message)?t:(0,s.jsx)("span",{className:"text-secondary",children:"No update message"})}),!a&&(0,s.jsx)(v.c,{loading:!q,height:22,width:136,children:(0,s.jsxs)(S.s,{children:[(0,s.jsx)(A.k,{children:(0,s.jsx)("p",{className:"text-xs text-secondary",children:(0,g.$)(U.createdAt)})}),(0,s.jsx)(_.Z,{side:"bottom",align:"start",children:(0,s.jsxs)(O.L,{children:["Created ",(0,p.GP)(U.createdAt,f.WL.timestamp)]})})]})}),(0,s.jsxs)("div",{className:"hidden flex-wrap gap-2 max-md-gutters:mt-1.5 max-md-gutters:flex",children:[U.updateGitCommitHash&&(0,s.jsxs)(E.C,{children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"Git ref:"}),(0,s.jsx)(D.u,{gitCommitHash:U.updateGitCommitHash,isGitWorkingTreeDirty:U.updateIsGitWorkingTreeDirty})]}),(0,s.jsxs)(E.C,{children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"Platforms: "}),J(W)]}),!i&&(0,s.jsxs)(E.C,{children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"Runtime:"}),U.updateRuntime.isFingerprint?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Fingerprint03Icon,{className:"icon-sm"}),(0,s.jsx)("p",{className:"text-xs text-default",children:U.updateRuntime.version.slice(0,7)})]}):(0,s.jsx)("p",{className:"text-xs text-default",children:U.updateRuntime.version})]}),(0,s.jsxs)(E.C,{children:[(0,s.jsx)("p",{className:"text-xs text-secondary",children:"Branch:"}),(0,s.jsx)("p",{className:"text-xs",children:U.branch.name})]})]})]}),K=(0,s.jsx)(C.n,{hideOnMobile:!0,theme:"interactive",className:"flex w-full flex-col gap-1 max-md-gutters:hidden",children:(0,s.jsxs)("div",{className:"flex min-h-[44px] w-full items-center gap-2 self-stretch",children:[(0,s.jsx)(l.BranchIcon,{}),(0,s.jsx)(T.k,{className:"truncate",children:U.branch.name})]})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.y,{}),(0,s.jsxs)(k.H,{children:[(0,s.jsx)(r.Link,{href:(0,j.Rv)(U.app.ownerAccount.name,U.app.slug,"updates/".concat(U.group)),className:"flex size-full items-center",children:Y}),(0,s.jsx)(w.u,{hideOnMobile:!0,app:U.app,gitCommitHash:U.updateGitCommitHash,isGitWorkingTreeDirty:U.updateIsGitWorkingTreeDirty}),(0,s.jsx)(C.n,{hideOnMobile:!0,children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:J(W)})}),!i&&(0,s.jsx)(r.Link,{href:(0,j.Rv)(U.app.ownerAccount.name,U.app.slug,"runtimes/".concat(encodeURIComponent(U.updateRuntime.version))),className:"flex h-full items-center",children:(0,s.jsx)(R.H,{runtime:U.updateRuntime,hideOnMobile:!0})}),(0,s.jsx)(r.Link,{href:(0,j.Rv)(U.app.ownerAccount.name,U.app.slug,"branches/".concat(encodeURIComponent(U.branch.name))),className:"flex h-full items-center max-md-gutters:hidden",children:K}),B&&(0,s.jsx)(C.n,{className:(0,r.mergeClasses)(!P&&o&&"pr-6"),children:(0,s.jsx)(b.$,{theme:"secondary",size:"sm",testID:"artifact-options-button",className:"shrink-0",leftSlot:(0,s.jsx)(u.QrCode01Icon,{className:"icon-sm"}),onClick:()=>{B(U.group)},children:"Preview"})}),P&&(0,s.jsxs)(C.n,{className:(0,r.mergeClasses)(o&&"pr-6"),hideOnMobile:!0,children:[G===M.X.LOADING?(0,s.jsx)(b.$,{disabled:!0,theme:"quaternary",leftSlot:(0,s.jsx)(y.$,{})}):(0,s.jsxs)(N.m,{className:"min-w-[180px]",trigger:(0,s.jsx)(b.$,{status:G,theme:"quaternary",leftSlot:(0,s.jsx)(c.DotsVerticalIcon,{className:"icon-md"})}),children:[(0,s.jsx)(I.t,{label:"Republish",Icon:x.RefreshCw02Icon,onSelect:$}),(0,s.jsx)(I.t,{destructive:!0,label:"Delete",Icon:h.Trash01Icon,onSelect:()=>{X(!0)}})]}),(0,s.jsx)(F.Y,{update:U,open:V,onClose:()=>{X(!1)},onDeletionFinished:()=>{window.location.href=(0,j.Rv)(U.app.ownerAccount.name,U.app.slug,"updates")}})]})]})]})}function J(e,t){return e.sort().map(e=>(0,s.jsxs)(S.s,{children:[(0,s.jsxs)(A.k,{children:["android"===e&&(0,s.jsx)(a.AndroidIcon,{className:t},e),"ios"===e&&(0,s.jsx)(i.AppleIcon,{className:t},e),"web"===e&&(0,s.jsx)(o.Earth02Icon,{className:t},e)]}),(0,s.jsx)(_.Z,{sideOffset:8,children:(0,s.jsxs)(O.L,{children:["android"===e&&"Android","ios"===e&&"iOS","web"===e&&"Web"]})})]},e))}},217948:(e,t,n)=>{n.d(t,{x:()=>s});let s=150},250455:(e,t,n)=>{n.d(t,{H:()=>o});var s=n(637876),r=n(766028),a=n(418674),i=n(310187),l=n(523805),c=n(549024);function o(e){let{className:t,runtime:n,hideOnMobile:o=!1}=e,d=n.isFingerprint?i.Fingerprint03Icon:a.AlignHorizontalCentre02Icon;return(0,s.jsxs)(l.n,{className:(0,r.mergeClasses)("min-h-[44px] w-full items-center gap-2 self-stretch truncate",t),hideOnMobile:o,theme:"interactive",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(d,{className:"icon-sm"})}),(0,s.jsx)(c.k,{className:"truncate",children:n.isFingerprint?(0,s.jsx)("code",{children:n.version.slice(0,7)}):n.version})]})}},361268:(e,t,n)=>{n.d(t,{$:()=>l});var s=n(58532),r=n(425096),a=n(598861),i=n(121182);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.WL.date,n=new Date(e);return Date.now()-n.getTime()<i.sM?(0,r.m)(n,{addSuffix:!0}):(0,s.GP)(n,t)}},377799:(e,t,n)=>{n.d(t,{Y:()=>x});var s=n(637876),r=n(636160),a=n(96427),i=n(903219),l=n(768069),c=n(764177);function o(){let e=(0,a._)(["\n    mutation ScheduleUpdateGroupDeletion($group: ID!) {\n  update {\n    scheduleUpdateGroupDeletion(group: $group) {\n      id\n      ...BackgroundJobReceiptData\n    }\n  }\n}\n    ",""]);return o=function(){return e},e}let d={},u=(0,i.J1)(o(),l.Y);function x(e){let{open:t,onClose:n,update:a,onDeletionFinished:i}=e,[l]=function(e){let t={...d,...void 0};return c.n(u,t)}();return(0,s.jsx)(r.z,{open:t,onClose:n,onConfirm:async()=>{var e,t;return null==(t=(await l({variables:{group:a.group}})).data)||null==(e=t.update)?void 0:e.scheduleUpdateGroupDeletion},onBackgroundJobReceiptPollError:()=>({errorIndicatesSuccess:!1}),onDeletionFinished:i,title:"Delete update group",message:(0,s.jsxs)("span",{className:"flex flex-col gap-2.5",children:[(0,s.jsx)("span",{children:"If you want to revert to a previous publish, you should use republish the last working update group instead."}),(0,s.jsx)("span",{children:"An update group should only be deleted in an emergency, like accidentally exposing a secret. In this case, revert to the last working update group by republishing and then proceed with the deletion."}),(0,s.jsx)("span",{className:"font-semibold text-default",children:"Deleting an update group when it is the latest can lead to inconsistent caching behavior by clients."}),(0,s.jsxs)("span",{children:["Are you sure you want to delete the update group"," ",(0,s.jsxs)("span",{className:"font-semibold text-default",children:['"',a.message,'"']})," in project"," ",a.app.slug,"?"]})]})})}},474522:(e,t,n)=>{n.d(t,{u:()=>l});var s=n(637876),r=n(671680),a=n(55033),i=n(701142);function l(e){let{gitCommitHash:t,isGitWorkingTreeDirty:n,gitRef:l}=e,{label:c}=l?(0,i.H)(l):{label:l};return l&&!(0,a.yg)(l)?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(r.GithubIcon,{className:"text-icon-tertiary max-md-gutters:hidden"}),(0,s.jsx)("span",{className:"truncate text-xs text-default",children:c})]}):t?(0,s.jsxs)("span",{className:"truncate text-xs text-default",children:[null==t?void 0:t.slice(0,7),n?"*":""]}):null}},629731:(e,t,n)=>{n.d(t,{$F:()=>x,fM:()=>u,rS:()=>d});var s=n(96427),r=n(903219),a=n(768069),i=n(154431),l=n(678248);function c(){let e=(0,s._)(["\n    query GetBackgroundJobReceiptById($id: ID!) {\n  backgroundJobReceipt {\n    byId(id: $id) {\n      ...BackgroundJobReceiptData\n    }\n  }\n}\n    ",""]);return c=function(){return e},e}let o={},d=(0,r.J1)(c(),a.Y);function u(e){let t={...o,...e};return i.IT(d,t)}function x(e){let t={...o,...e};return l._(d,t)}},636160:(e,t,n)=>{n.d(t,{z:()=>N});var s=n(637876),r=n(483070),a=n(548747),i=n(157069),l=n(14232),c=n(194070),o=n(197093),d=n(700806),u=n(500723),x=n(125050),h=n(515479),p=n(360203),m=n(217948),f=n(130514),g=n(634306),j=n(206972),y=n(923333),b=n(71215),v=n(994314);function N(e){let{open:t,onClose:n,onConfirm:N,onBackgroundJobReceiptPollError:I,onDeletionFinished:w,title:D,preMessageElement:C,message:T,confirmationConfiguration:E}=e,[k,R]=(0,l.useState)(y.X.IDLE),[L,_]=(0,l.useState)(!0),[S,O]=(0,l.useState)(),[A,M]=(0,l.useState)(""),[F,G]=(0,l.useState)(!1),{pollForBackgroundJobReceiptAsync:J}=(0,v.z9)({onBackgroundJobReceiptPollError:I}),P=k!==y.X.IDLE;function $(){P||(n(),setTimeout(()=>{O(void 0),R(y.X.IDLE),G(!1),M("")},2*m.x))}async function B(){O(void 0),R(y.X.LOADING);try{let e=await N();if(!e)throw Error("Failed to start deletion.");try{await J(e),R(y.X.SUCCESS),w(),n()}catch(e){if(e instanceof v.hc)R(y.X.IDLE),_(e.errorData.errorType!==v.nT.TIMEOUT),O(function(e){switch(e.errorData.errorType){case v.nT.NULL_RECEIPT:return"Deletion failed. Try again.";case v.nT.JOB_FAILED_NO_WILL_RETRY:var t;return"".concat(null!=(t=e.errorData.receiptErrorMessage)?t:"Deletion failed.");case v.nT.TIMEOUT:return"Deletion is taking longer than expected. It may still succeed in a few minutes. Wait an hour to see if it is deleted and then try again."}}(e));else throw e}}catch(t){if(t instanceof r.K4){var e;O((null==(e=t.graphQLErrors)?void 0:e.length)?t.graphQLErrors[0].message:t.message)}else t instanceof Error&&O(t.message);R(y.X.IDLE)}}let H=(0,s.jsxs)("div",{className:"flex flex-col gap-1.5",children:[C,(0,s.jsx)("p",{className:"text-xs text-secondary",children:T}),(0,s.jsx)("p",{className:"text-xs text-secondary",children:"This action cannot be undone."})]}),U=(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 py-4",children:[(0,s.jsx)(c.$,{size:"lg",className:"stroke-icon-default"}),(0,s.jsx)("p",{className:"text-center text-xs text-secondary",children:"Deletion processing…"})]});return E?(0,s.jsx)(h.D,{open:t,onOpenChange:$,children:(0,s.jsx)(d.C,{className:"rounded-lg",children:(0,s.jsxs)(f.lV,{onSubmit:async()=>{F?await B():G(!0)},disabled:P||!L,variant:"flat",children:[(0,s.jsx)(p.L,{title:D,icon:(0,s.jsx)(i.Trash03Icon,{})}),(0,s.jsxs)(u.d,{children:[!P&&!F&&(0,s.jsx)(j.g,{htmlFor:"confirmValueInput",description:E.confirmationPromptMessage,children:(0,s.jsx)(b.p,{id:"confirmValueInput",onChange:e=>{M(e.target.value)},placeholder:E.requiredConfirmedValue,autoComplete:"off"})}),!P&&F&&H,P&&U,(0,s.jsx)(g.j,{error:S})]}),(0,s.jsx)(x.E,{className:"flex flex-1 items-center justify-end gap-4 px-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.$,{theme:"quaternary",disabled:P||!L,onClick:$,children:"Cancel"}),(0,s.jsx)(o.$,{testID:"confirm-deletion-button",disabled:P||A!==E.requiredConfirmedValue||!L,rightSlot:F?void 0:(0,s.jsx)(a.ChevronRightIcon,{}),theme:F?"secondary-destructive":"secondary",type:"submit",children:F?"Delete":"Confirm"})]})})]})})}):(0,s.jsx)(h.D,{open:t,onOpenChange:$,children:(0,s.jsx)(d.C,{className:"rounded-lg",children:(0,s.jsxs)(f.lV,{onSubmit:async()=>{await B()},disabled:P||!L,variant:"flat",children:[(0,s.jsx)(p.L,{title:D,icon:(0,s.jsx)(i.Trash03Icon,{})}),(0,s.jsxs)(u.d,{children:[!P&&H,P&&U,(0,s.jsx)(g.j,{error:S})]}),(0,s.jsx)(x.E,{className:"flex flex-1 items-center justify-end gap-4 px-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.$,{theme:"quaternary",disabled:P||!L,onClick:$,children:"Cancel"}),(0,s.jsx)(o.$,{testID:"delete-submit-button",disabled:P||!L,theme:"secondary-destructive",type:"submit",children:"Delete"})]})})]})})})}},768069:(e,t,n)=>{n.d(t,{Y:()=>a});var s=n(96427);function r(){let e=(0,s._)(["\n    fragment BackgroundJobReceiptData on BackgroundJobReceipt {\n  id\n  state\n  tries\n  willRetry\n  resultId\n  resultType\n  resultData\n  errorCode\n  errorMessage\n  createdAt\n  updatedAt\n}\n    "]);return r=function(){return e},e}let a=(0,n(903219).J1)(r())},888299:(e,t,n)=>{n.d(t,{H:()=>a});var s=n(637876),r=n(14232);function a(e){let{children:t,...n}=e;return(0,s.jsx)(r.Fragment,{...n,children:t})}},994314:(e,t,n)=>{n.d(t,{hc:()=>d,nT:()=>o,z9:()=>u});var s=n(767994),r=n(483070),a=n(618334),i=n(426259),l=n(376950),c=n(629731),o=function(e){return e[e.NULL_RECEIPT=0]="NULL_RECEIPT",e[e.JOB_FAILED_NO_WILL_RETRY=1]="JOB_FAILED_NO_WILL_RETRY",e[e.TIMEOUT=2]="TIMEOUT",e}({});class d extends Error{constructor(e){super(""),this.errorData=e}}function u(e){let t=(0,s.m)();async function n(e){try{let{data:n,error:s}=await t.query({query:c.rS,fetchPolicy:"network-only",variables:{id:e}});return[null==n?void 0:n.backgroundJobReceipt.byId,s]}catch(e){if(e instanceof r.K4)return[void 0,e];throw e}}return{pollForBackgroundJobReceiptAsync:async function(t){return await new Promise((s,c)=>{let o=0,u=(0,i.E)(async function(){function x(e){(0,i.H)(u),c(e)}let[h,p]=await n(t.id);if(!h){if(p instanceof r.K4){var m;let t=null==e||null==(m=e.onBackgroundJobReceiptPollError)?void 0:m.call(e,p);if(null==t?void 0:t.errorIndicatesSuccess){(0,i.H)(u),s(null);return}}x(new d({errorType:0}));return}if(h.state===l.TT.Failure&&!h.willRetry)return void x(new d({errorType:1,receiptErrorMessage:h.errorMessage}));if(o>90){h.errorMessage&&(a.wd(h.errorMessage),console.error(h.errorMessage)),x(new d({errorType:2}));return}if(h.state===l.TT.Success){(0,i.H)(u),s(h);return}o++},1e3)})}}}d.prototype.name="BackgroundJobReceiptPollError",Object.defineProperty(d.prototype,"name",{enumerable:!1})}}]);